{% extends "base.html" %}

{% block title %}ManutenÃ§Ãµes - Sistema de ManutenÃ§Ã£o{% endblock %}

{% block content %}
<!-- Enhanced Main Card -->
<div class="card">
    <div class="card-header">
        <span class="card-header-icon">ğŸ”§</span>
        <h3>ManutenÃ§Ãµes Realizadas</h3>
        {% if manutencoes %}<span class="badge">{{ manutencoes|length }}</span>{% endif %}
    </div>
    <div class="card-body">
        <!-- Enhanced Filters -->
        <div class="filters-section mb-4">
            <div class="filter-options">
                <div class="filter-tabs">
                    <a href="/manutencoes" class="filter-tab {% if tipo_atual == 'todas' %}active{% endif %}">
                        <span class="filter-icon">ğŸ”§</span>
                        <span>Todas</span>
                    </a>
                    <a href="/manutencoes?tipo=loja" class="filter-tab {% if tipo_atual == 'loja' %}active{% endif %}">
                        <span class="filter-icon">ğŸª</span>
                        <span>Lojas</span>
                    </a>
                    <a href="/manutencoes?tipo=veiculo" class="filter-tab {% if tipo_atual == 'veiculo' %}active{% endif %}">
                        <span class="filter-icon">ğŸš—</span>
                        <span>VeÃ­culos</span>
                    </a>
                    <a href="/manutencoes/cadastrar" class="filter-tab primary">
                        <span class="filter-icon">â•</span>
                        <span>Nova</span>
                    </a>
                </div>
                <div class="filter-info">
                    <span class="filter-count">{{ manutencoes|length }} manutenÃ§Ã£o(Ãµes) encontrada(s)</span>
                </div>
            </div>
        </div>
        
        {% if not manutencoes %}
            <div class="empty-state">
                <div class="empty-state-icon">ğŸ”§</div>
                <h4>Nenhuma manutenÃ§Ã£o registrada</h4>
                <p>Comece registrando a primeira manutenÃ§Ã£o do sistema.</p>
                <a href="/manutencoes/cadastrar" role="button" class="btn btn-primary">Registrar Primeira ManutenÃ§Ã£o</a>
            </div>
        {% else %}
            <!-- Enhanced Maintenance List -->
            <div class="maintenance-list">
                {% for manutencao in manutencoes %}
                    <div class="maintenance-card {{ manutencao.tipo }}">
                        <div class="maintenance-header">
                            <div class="maintenance-icon">
                                {% if manutencao.tipo == 'loja' %}ğŸª{% else %}ğŸš—{% endif %}
                            </div>
                            <div class="maintenance-info">
                                <h4>{{ manutencao.titulo }}</h4>
                                <p class="date">
                                    ğŸ“… {{ manutencao.data_manutencao.strftime('%d/%m/%Y') }}
                                    {% if manutencao.tipo == 'loja' and manutencao.loja %}
                                        â€¢ ğŸª {{ manutencao.loja.nome }}
                                    {% elif manutencao.tipo == 'veiculo' and manutencao.veiculo %}
                                        â€¢ ğŸš— {{ manutencao.veiculo.placa }} - {{ manutencao.veiculo.modelo }}
                                    {% endif %}
                                </p>
                                {% if manutencao.descricao %}
                                    <p class="maintenance-description">
                                        {{ manutencao.descricao[:150] }}{% if manutencao.descricao|length > 150 %}...{% endif %}
                                    </p>
                                {% endif %}
                                {% if manutencao.fotos %}
                                    <div class="maintenance-badges">
                                        <span class="info-badge">
                                            ğŸ“· {{ manutencao.fotos|length }} foto(s)
                                        </span>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        <div class="maintenance-footer">
                            <div class="price">R$ {{ "%.2f"|format(manutencao.preco_total) }}</div>
                            <a href="/manutencoes/{{ manutencao.id }}" role="button" class="btn btn-secondary">
                                Ver Detalhes
                            </a>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
